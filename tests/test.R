library(xyz)
set.seed(1000)
n1 <- 300
n2 <- 200
p <- 1000
X1 <- matrix(rnorm(n1*p),n1,p)
Y1 <- 4*X1[,1]*X1[,2]-5*X1[,4]+rnorm(n1)
#Y1 <- 4*X1[,1]*X1[,2]+rnorm(n1)
X2 <- matrix(rnorm(n2*p),n2,p)
Y2 <- -7*X2[,100]*X2[,211]+13*X2[,35]+6*X2[,47]+rnorm(n2)
#Y2 <- X2[,100]*X2[,211]+rnorm(n2)
X <- rbind(X1,X2)
Y <- c(Y1,Y2)

#wei <- c(rep(0.9,n1),rep(0.1,n2))
wei <- c(rep(0.1,n1),rep(0.9,n2))
result <- xyz_regression(X2,Y2,n_lambda = 10, alpha = 0.9, L = 10)
# result3 <- ic.xyz_regression(X1,Y1,n_lambda = 10, alpha = 0.9, L = 10)
x11()
print(result)
plot(result)
result2 <- xyz_regression(X,Y,wei,n_lambda = 10, alpha = 0.9, L = 10)
# result3 <- ic.xyz_regression(X,Y,weights = wei,n_lambda = 10, alpha = 0.9, L = 10)
print(result2)
x11()
plot(result2,xvar = "lambda")
# abline(v=log(result3$lambda),lty=2)
